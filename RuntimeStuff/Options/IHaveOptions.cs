namespace RuntimeStuff.Options
{
    /// <summary>
    /// Определяет контракт для объектов, содержащих набор опций
    /// строго типизированного типа.
    /// </summary>
    /// <typeparam name="T">
    /// Тип опций, производный от <see cref="OptionsBase{T}"/>.
    /// </typeparam>
    /// <remarks>
    /// Интерфейс предназначен для использования в публичных API,
    /// где требуется доступ к опциям без потери типовой безопасности.
    /// </remarks>
    public interface IHaveOptions<out T> : IHaveOptions
        where T : OptionsBase<T>, new()
    {
        /// <summary>
        /// Возвращает набор опций, ассоциированный с объектом.
        /// </summary>
        /// <remarks>
        /// Свойство является ковариантным (<c>out T</c>) и предназначено
        /// только для чтения. Для изменения опций рекомендуется использовать
        /// методы самого объекта опций или создавать новый экземпляр.
        /// </remarks>
        new T Options { get; }
    }

    /// <summary>
    /// Определяет базовый контракт для объектов,
    /// содержащих набор опций.
    /// </summary>
    /// <remarks>
    /// Используется как нетипизированная версия интерфейса
    /// <see cref="IHaveOptions{T}"/> для сценариев,
    /// где конкретный тип опций неизвестен во время компиляции.
    /// </remarks>
    public interface IHaveOptions
    {
        /// <summary>
        /// Получает или задаёт набор опций, ассоциированный с объектом.
        /// </summary>
        /// <remarks>
        /// В типизированных сценариях рекомендуется использовать
        /// интерфейс <see cref="IHaveOptions{T}"/> вместо данного.
        /// </remarks>
        OptionsBase Options { get; set; }
    }
}